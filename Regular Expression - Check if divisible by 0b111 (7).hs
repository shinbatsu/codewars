a     = "(10|000)"
b     = "0101*0"
c    = "11|001|" ++ b
d    = "(1|00)1|" ++ b

opt_0   = "100" ++ a ++ "*" ++ "(" ++ c ++ ")"
opt_1    = "1101*0"
opt_2    = "101"
a1      = "(" ++ opt_0 ++ "|" ++ opt_1 ++ "|" ++ opt_2 ++ ")"
rec_1    = "1" ++ a ++ "*" ++ "(" ++ d ++ ")"
rec_2      = "001*0"
a2      = "(" ++ rec_1 ++ "|" ++ rec_2 ++ ")*"
end_1     = "1" ++ a ++ "*011"
end_2       = "01"
a3      = "(" ++ end_1 ++ "|" ++ end_2 ++ ")"
ga       = a1 ++ a2 ++ a3

b1           = "100" ++ a ++ "*011"
b2           = "0"
b3           = "111"
gb       = "(" ++ b1 ++ "|" ++ b2 ++ "|" ++ b3 ++ ")"

solution :: String
solution     = "^(" ++ ga ++ "|" ++ gb ++ ")+$"